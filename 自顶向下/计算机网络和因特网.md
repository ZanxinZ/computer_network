# 1 计算机网络和因特网

## 1.3 网络核心

### 1.3.1 分组交换

端系统彼此交换**报文**（message）

**分组**（packet）：源端系统为了向目的端系统发送一个报文，源将报文划分为较小的数据块

源和目的地之间，每个分组都通过**通信链路**和**分组交换机**（packet switch）传送。

交换机：**路由器（router）**、**链路层交换机（link-layer switch）。**

1. **存储转发传输（store-and-forward transmission）**

   路由器转发时，接收并且缓存整个分组，**整个分组接收完成之后**，再开始转发。

   路由器的任务：将输入链路转移到另外一条唯一的链路。

   假设有3个分组进行传输。源与目的地中间只有一个路由器。

   时刻0：开始传输。

   时刻 L/R：路由器刚好传输了第一个分组并开始输出。 

   时刻 2L/R：目的地收到第一个分组，并且路由器已经收到第二个分组并开始输出第二个分组。

   时刻 3L/R：目的地收到第二个分组，并且路由器已经收到第三个分组并开始输出第三个分组。

   时刻 4L/R：目的地收到第三个分组。

   时延就是 L/R

   端到端时延（存储转发时延）
   $$
   d_{端到端}=N\frac L R
   $$
   N-1：源与目的地之间有N-1台路由器。

   L：length 分组长度（比特）

   R：rate 链路传输速率（R 比特/秒）

   ***经过 N-1个路由器需要 N 个传输时间。***

2. **排队时延和分组丢失**

   每台分组交换机有多条链路与之相连，对于每条相连的链路，该分组交换机具有一个**输出缓存**（output buffer 也称为输出队列（output queue））。

   如果到达的分组发现该链路正忙于传输其他分组，那么该到达分组必须在<u>输出缓存</u>中等待。

   排队时延：在输出缓存中等待所产生。

   由于缓存空间有限，一个到达的分组可能发现缓存已经**被其他等待传输的分组完全充满**，将出现**分组丢失**（ <u>丢包</u> packet loss），**到达的分组**或者**已经排队的分组**将被遗弃。

3. 转发表和路由选择协议

   每一个端系统具有一个 IP 地址。

   每台路由器具有一个**转发表（forwarding table）**，用于将目的地址（或目的地址的一部分）映射成输出链路。当某个分组到达路由器时，路由器检查该分组的记录的 IP 地址，并用这个地址搜索转发表，找出一条适当链路，路由器将分组导向该出链路。

   **路由选择协议（routing protocol）**：自动地设置转发表。某个路由器选择协议可以决定从每台路由器到每个目的地的最短路径，并使用这些最短路径结果来配置路由器中的转发表。

### 1.3.2电路交换

发送方和接受方在通信过程中需要维护一个可靠连接，（为该连接预留带宽）。

端到端连接（end-to-end connection）

电路交换缺点：（静默期 silent period）有的时候，双方发送空信息也需要占用带宽，造成带宽资源浪费，而分组交换克服了这个缺点。

1. 电路交换中的复用

   - 频分复用（Frequency - Division Multiplexing）

     不同服务使用不同频段，该频段宽度称为**带宽（band-width）**

     电路网络：4kHz

     调频无线电台：88MHz~108MHz 每个电台被分配一个特定频段。

   - 时分复用（Time - Division Multiplexing）

     为每条电路分配一个编号，按照编号，每条电路在特定的时隙中周期性地获得所有带宽。

### 1.3.3 网络的网络

ISP（Internet Service Provider）

端系统，经过一个**接入ISP**与因ISP特网相连。该接入ISP使用的接入技术：DSL、电缆、FTTH、WiFi、蜂窝。

网络的网络

网络结构1：**单一的**全球传输 ISP 互联所有接入ISP。接入ISP（客户），全球传输ISP（提供商）

网络结构2：多个全球传输 ISP 互联所有接入ISP。（全球传输ISP之间必须互联通信）。

网络结构3：使用区域 ISP ，组建多层次的结构。

现在的因特网：**比结构3增加了（存在点（Point of Presence）、多宿、对等、因特网交换点）**

**存在点 PoP**：提供商网络中一台或多台路由器群组。

**多宿（multi-home）**：任何ISP（除了第一层 ISP），可以与两个或以上提供商 ISP 连接。

**对等（peer）**：相同等级结构层次的邻近一对 ISP 可以对等，数据直接传输（通常不进行结算）。

**因特网交换点（Internet Exchange Point）**：IXP 

## 1.4  分组中的时延、丢包、吞吐量 

# 问题

1.1 

R1 主机和端系统的不同？

主机是管理者，端系统被管理；主机是共享者，端系统是使用者。

端系统：PC、智能手机、Web服务器、电子邮件服务

