# 2 应用层

## 2.1 应用层协议原理

### 2.1.1 网络应用程序体系结构

- 客户-服务器体系结构

  虚拟服务器：配备大量主机的**数据中心（data center）**

- P2P 体系结构

  端到端通信，具有自扩展性（self-scalability）

### 2.1.2 进程通信

进行通信的实际上是**进程（process）**。一个进程可以被认为是运行在端系统的一个程序。

多个进程运行在相同的端系统上，使用**进程进程通信机制**相互通信。

进程间通信规则因操作系统不同而不同。

不同端系统上的进程，通过跨越计算机网络交换**报文（message）**来相互通信。

发送进程生成并向网络中发送报文；接收进程接收这些报文并通过会送报文进行响应。

1. 客户端和服务器端进程：发起一方是客户，等待联系的进程是服务器。

2. 进程与计算机网络之间的接口：进程通过一个称为**套接字（socket）**的软件接口向网络发送报文和接收报文。

   套接字：同一台主机内，应用层与运输层之间的接口。也称为<u>应用程序</u>与<u>网络</u>之间的**应用程序编程接口（API）**

   开发者可以控制套接字应用层端的的一切，但对运输层端仅有（1、选择运输层协议。2、设定几个参数，如最大缓存、最大报文段长度。）

3. 进程寻址。

   为了标识接收进程需要两种信息：

   - 目的主机地址。

   - 目的主机中指定进程的标识符（端口）。

     Web ：80 ;   SMTP: 25

### 2.1.3 可供应用程序使用的运输服务

1. 可靠数据传输

2. 吞吐量

   **带宽敏感性应用（bandwidth-sensitive application）**：对吞吐量有要求的应用。

   **弹性应用（elastic application）**可以根据当时的带宽或多或少地利用可供使用的吞吐量。电子邮件、文件传输、Web传送都属于弹性应用。 

3. 定时

4. 安全性

   **运输层协议**在将数据交付给接收进程之前对**数据进行解密**。

### 2.1.4 因特网提供的运输服务

1. TCP （Transmission Control Protocol）

   - 面向连接

     握手完成后，一个 TCP 连接在两个进程的套接字之间建立，这个连接是**全双工**的。

   - 可靠的数据传送

     进程之间通信，无差错、按适当顺序交付所有发送的数据。（字节流的方式）

     当网络出现拥塞时，TCP 的**拥塞控制机制**会抑制发送进程。

   TCP 安全：

   - **安全套接字层（Secure Socket Layer ，SSL）**：加密、数据完整性鉴别、端点鉴别。（在**应用层上实现**的，对 TCP 的增强）

2. UDP（User Datagram Protocol）

   - 无连接

   - 尽最大能力地交付

     （UDP没有拥塞控制机制，所以因特网电话 UDP 通信失败就使用 TCP 作为备份）

## 2.2 Web 和 HTTP

### 2.2.1 概况

Web 的应用层协议是 HTTP（Hyper Text Transmission Protocol）

分层体系结构最大的优点：HTTP 协议不用担心数据丢失，也不关注 TCP 从网络的数据丢失和乱序故障中恢复的细节。

HTTP 协议中，服务器不会保存关于客户的任何信息，所以HTTP是一个**无状态（stateless protocol）**的协议。

Web 服务器常开，有一个固定的 IP 地址。

### 2.2.2 非持续连接和持续连接